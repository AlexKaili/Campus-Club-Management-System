


# æ ¡å›­ç¤¾å›¢æ´»åŠ¨ç®¡ç†ç³»ç»Ÿ - é¡¹ç›®æ–‡æ¡£

## ç›®å½•
- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [åŠŸèƒ½æ¨¡å—](#åŠŸèƒ½æ¨¡å—)
- [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
- [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
- [APIæ¥å£](#apiæ¥å£)
- [WebSocketé€šä¿¡](#websocketé€šä¿¡)
- [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---
## é¡¹ç›®é¢„è§ˆï¼š
### éƒ¨åˆ†å‰ç«¯é¡µé¢ï¼š
<img width="1914" height="1381" alt="image" src="https://github.com/user-attachments/assets/37b02fbf-f9ba-49a4-8f7d-cdf4acdf1caf" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/0d215562-86ff-4792-8edd-47386d8ccb3b" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/f19e9b03-23cd-4101-abb7-96086eaeabfa" />
<img width="1911" height="646" alt="image" src="https://github.com/user-attachments/assets/7553c53b-502b-463d-9703-f2c64fccedbc" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/fbde81dd-36ae-42e6-9bfd-a43eb725cb73" />

### éƒ¨åˆ†åå°ç®¡ç†é¡µé¢ï¼š
![ç¤¾å›¢ç®¡ç†åå°_ç”³è¯·ç®¡ç†](https://github.com/user-attachments/assets/ccd3dabe-d853-4460-a459-aae91fe62e98)
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/4614ce99-4003-41dc-91e0-4055f7bf72c1" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/bc91a458-53a1-4bf4-ae3f-3da958af59cb" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/99f3fca9-cbff-43e9-bf99-0a5e1f4c461f" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/2d992aac-4c47-4619-a064-8cf979327fbe" />
<img width="1914" height="1780" alt="image" src="https://github.com/user-attachments/assets/4aa7d4e5-2552-4e44-8070-1ec7a690f9a4" />

## æºç è´­ä¹°è”ç³»æ–¹å¼

![15ffea3fd0043ae3e7a188c1b611d6b1](https://github.com/user-attachments/assets/feb164db-fc0f-4e9c-95cf-c2f9e45609f4)

## è´­ä¹°åŒ…å«å†…å®¹ï¼š

<img width="306" height="239" alt="image" src="https://github.com/user-attachments/assets/3cc357b3-e51f-4aa0-93a3-36a33e54f01e" />


## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®ç®€ä»‹
æ ¡å›­ç¤¾å›¢æ´»åŠ¨ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºDjangoå¼€å‘çš„ç»¼åˆæ€§ç¤¾å›¢ç®¡ç†å¹³å°ï¼Œæ—¨åœ¨ä¸ºé«˜æ ¡ç¤¾å›¢æä¾›å®Œæ•´çš„çº¿ä¸Šç®¡ç†è§£å†³æ–¹æ¡ˆã€‚ç³»ç»Ÿæ”¯æŒç¤¾å›¢åˆ›å»ºã€æ´»åŠ¨å‘å¸ƒã€æˆå‘˜ç®¡ç†ã€å®æ—¶èŠå¤©ã€æ´»åŠ¨ç­¾åˆ°ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

### ä¸»è¦ç‰¹æ€§
- ğŸ¢ **ç¤¾å›¢ç®¡ç†**ï¼šç¤¾å›¢åˆ›å»ºç”³è¯·ã€ä¿¡æ¯ç»´æŠ¤ã€æˆå‘˜ç®¡ç†
- ğŸ“… **æ´»åŠ¨ç®¡ç†**ï¼šæ´»åŠ¨å‘å¸ƒã€æŠ¥åå®¡æ ¸ã€ç­¾åˆ°ç®¡ç†
- ğŸ’¬ **å®æ—¶èŠå¤©**ï¼šåŸºäºWebSocketçš„ç¾¤èŠåŠŸèƒ½ï¼Œè‡ªåŠ¨åˆ›å»ºç¤¾å›¢/æ´»åŠ¨ç¾¤ç»„
- ğŸ”” **é€šçŸ¥ç³»ç»Ÿ**ï¼šå®æ—¶é€šçŸ¥æ¨é€ï¼Œç”³è¯·å®¡æ‰¹çŠ¶æ€æ›´æ–°
- ğŸ‘¥ **æƒé™ç®¡ç†**ï¼šå¤šè§’è‰²æƒé™æ§åˆ¶ï¼ˆå­¦ç”Ÿã€ç¤¾å›¢ç®¡ç†å‘˜ã€ç³»ç»Ÿç®¡ç†å‘˜ï¼‰
- ğŸ“Š **æ•°æ®ç»Ÿè®¡**ï¼šç¤¾å›¢æ•°æ®ã€æ´»åŠ¨æ•°æ®ã€ç­¾åˆ°ç»Ÿè®¡å¯è§†åŒ–
- ğŸ¨ **ç°ä»£åŒ–UI**ï¼šåŸºäºTailwind CSSçš„å“åº”å¼è®¾è®¡

### é¡¹ç›®ç›®æ ‡
- ç®€åŒ–ç¤¾å›¢ç®¡ç†æµç¨‹ï¼Œæé«˜ç®¡ç†æ•ˆç‡
- ä¿ƒè¿›ç¤¾å›¢æˆå‘˜ä¹‹é—´çš„äº¤æµä¸äº’åŠ¨
- ä¸ºå­¦æ ¡æä¾›ç»Ÿä¸€çš„ç¤¾å›¢ç®¡ç†å¹³å°
- æä¾›æ•°æ®æ”¯æŒï¼Œè¾…åŠ©å†³ç­–åˆ†æ

---

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **æ¡†æ¶**: Django 5.2
- **Pythonç‰ˆæœ¬**: 3.12
- **WebSocket**: Django Channels 4.3.2
- **å¼‚æ­¥æ”¯æŒ**: Channels Redis 4.3.0
- **æ•°æ®åº“**: SQLite
- **å›¾åƒå¤„ç†**: Pillow
- **HTTPè¯·æ±‚**: Requests

### å‰ç«¯æŠ€æœ¯
- **CSSæ¡†æ¶**: Tailwind CSS (CDN)
- **å›¾æ ‡åº“**: Font Awesome 6
- **JavaScriptæ¡†æ¶**: Alpine.js 3.x
- **å®æ—¶é€šä¿¡**: WebSocket API

### å¼€å‘å·¥å…·
- **ASGIæœåŠ¡å™¨**: Daphne
- **ç‰ˆæœ¬æ§åˆ¶**: Git
- **è™šæ‹Ÿç¯å¢ƒ**: venv

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯å±‚ (Templates)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ç¤¾å›¢å¹¿åœº  â”‚  â”‚ æ´»åŠ¨ä¸­å¿ƒ  â”‚  â”‚ èŠå¤©ç³»ç»Ÿ  â”‚  â”‚ ç®¡ç†åå°  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸šåŠ¡é€»è¾‘å±‚ (Views)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ç¤¾å›¢ç®¡ç†  â”‚  â”‚ æ´»åŠ¨ç®¡ç†  â”‚  â”‚ ç”¨æˆ·ç®¡ç†  â”‚  â”‚ é€šçŸ¥ç®¡ç†  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  WebSocketå±‚ (Consumers)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  ChatConsumer    â”‚       â”‚ NotificationConsumerâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®å±‚ (Models)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”     â”‚
â”‚  â”‚Userâ”‚ â”‚Clubâ”‚ â”‚Activityâ”‚ â”‚Chatâ”‚ â”‚Notificationâ”‚ ...   â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®åº“ (SQLite)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åº”ç”¨æ¨¡å—åˆ’åˆ†
```
club_management/          # é¡¹ç›®ä¸»ç›®å½•
â”œâ”€â”€ accounts/            # ç”¨æˆ·è´¦æˆ·æ¨¡å—
â”œâ”€â”€ clubs/              # ç¤¾å›¢ç®¡ç†æ¨¡å—
â”œâ”€â”€ activities/         # æ´»åŠ¨ç®¡ç†æ¨¡å—
â”œâ”€â”€ chat/               # èŠå¤©ç³»ç»Ÿæ¨¡å—
â”œâ”€â”€ system_admin/       # ç³»ç»Ÿç®¡ç†æ¨¡å—
â””â”€â”€ club_management/    # é¡¹ç›®é…ç½®
```

---

## åŠŸèƒ½æ¨¡å—

### 1. ç”¨æˆ·ç®¡ç†æ¨¡å— (accounts)

#### åŠŸèƒ½åˆ—è¡¨
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•/ç™»å‡º
- âœ… ä¸ªäººèµ„æ–™ç®¡ç†ï¼ˆå¤´åƒã€å­¦å·ã€æ‰‹æœºå·ç­‰ï¼‰
- âœ… å¯†ç ä¿®æ”¹
- âœ… é€šçŸ¥ä¸­å¿ƒ
- âœ… è§’è‰²æƒé™ç®¡ç†

#### æ ¸å¿ƒæ¨¡å‹
```python
class User(AbstractUser):
    role = models.CharField(max_length=20, choices=ROLE_CHOICES)
    student_id = models.CharField(max_length=20, unique=True)
    phone = models.CharField(max_length=11)
    avatar = models.ImageField(upload_to='avatars/')
```

#### ä¸»è¦è§†å›¾
- `register()` - ç”¨æˆ·æ³¨å†Œ
- `profile()` - ä¸ªäººä¸­å¿ƒ
- `update_profile()` - æ›´æ–°èµ„æ–™
- `change_password()` - ä¿®æ”¹å¯†ç 
- `upload_avatar()` - ä¸Šä¼ å¤´åƒ
- `notifications()` - é€šçŸ¥åˆ—è¡¨

---

### 2. ç¤¾å›¢ç®¡ç†æ¨¡å— (clubs)

#### åŠŸèƒ½åˆ—è¡¨
- âœ… ç¤¾å›¢åˆ—è¡¨å±•ç¤ºï¼ˆåˆ†ç±»ç­›é€‰ã€æœç´¢ï¼‰
- âœ… ç¤¾å›¢è¯¦æƒ…é¡µ
- âœ… ç¤¾å›¢åˆ›å»ºç”³è¯·ï¼ˆéœ€ç³»ç»Ÿç®¡ç†å‘˜å®¡æ‰¹ï¼‰
- âœ… ç¤¾å›¢å…¥ä¼šç”³è¯·ï¼ˆéœ€ç¤¾å›¢ç®¡ç†å‘˜å®¡æ‰¹ï¼‰
- âœ… ç¤¾å›¢ä¿¡æ¯ç¼–è¾‘ï¼ˆåç§°ã€æè¿°ã€åˆ†ç±»ã€Logoã€å°é¢ï¼‰
- âœ… æˆå‘˜ç®¡ç†ï¼ˆæ·»åŠ ã€ç§»é™¤ã€è§’è‰²å˜æ›´ï¼‰
- âœ… ç¤¾å›¢ç®¡ç†åå°

#### æ ¸å¿ƒæ¨¡å‹
```python
class Club(models.Model):
    name = models.CharField(max_length=100)
    description = models.TextField()
    category = models.CharField(max_length=50, choices=CATEGORY_CHOICES)
    president = models.ForeignKey(User, on_delete=models.CASCADE)
    logo = models.ImageField(upload_to='clubs/logos/')
    cover_image = models.ImageField(upload_to='clubs/covers/')
    status = models.CharField(max_length=20, choices=STATUS_CHOICES)

class Membership(models.Model):
    club = models.ForeignKey(Club, on_delete=models.CASCADE)
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    role = models.CharField(max_length=20, choices=ROLE_CHOICES)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES)
```

#### ç¤¾å›¢ç®¡ç†åå°åŠŸèƒ½
- **æ¦‚è§ˆé¡µ**ï¼šç¤¾å›¢ç»Ÿè®¡æ•°æ®ã€æ´»åŠ¨ç»Ÿè®¡ã€å¾…å¤„ç†ç”³è¯·
- **ç¤¾å›¢ç®¡ç†**ï¼šæŸ¥çœ‹ç®¡ç†çš„æ‰€æœ‰ç¤¾å›¢ã€ç”³è¯·åˆ›å»ºæ–°ç¤¾å›¢
- **æ´»åŠ¨ç®¡ç†**ï¼šæŸ¥çœ‹ç®¡ç†çš„æ‰€æœ‰æ´»åŠ¨ã€åˆ›å»ºæ–°æ´»åŠ¨
- **ç”³è¯·ç®¡ç†**ï¼šå®¡æ‰¹ç¤¾å›¢å…¥ä¼šç”³è¯·ã€æ´»åŠ¨æŠ¥åç”³è¯·
- **ç­¾åˆ°ç®¡ç†**ï¼šæŸ¥çœ‹æ´»åŠ¨ç­¾åˆ°æƒ…å†µã€ç”Ÿæˆç­¾åˆ°ç 

---

### 3. æ´»åŠ¨ç®¡ç†æ¨¡å— (activities)

#### åŠŸèƒ½åˆ—è¡¨
- âœ… æ´»åŠ¨åˆ—è¡¨å±•ç¤ºï¼ˆçŠ¶æ€ç­›é€‰ã€æœç´¢ï¼‰
- âœ… æ´»åŠ¨è¯¦æƒ…é¡µ
- âœ… æ´»åŠ¨åˆ›å»ºï¼ˆéœ€ç¤¾å›¢ç®¡ç†å‘˜æƒé™ï¼‰
- âœ… æ´»åŠ¨æŠ¥åï¼ˆéœ€å®¡æ‰¹ï¼‰
- âœ… æ´»åŠ¨ç­¾åˆ°ï¼ˆç­¾åˆ°ç éªŒè¯ï¼‰
- âœ… æ´»åŠ¨è¯„è®º
- âœ… æ´»åŠ¨å°é¢å›¾ï¼ˆUnsplash APIï¼‰

#### æ ¸å¿ƒæ¨¡å‹
```python
class Activity(models.Model):
    club = models.ForeignKey(Club, on_delete=models.CASCADE)
    title = models.CharField(max_length=200)
    description = models.TextField()
    location = models.CharField(max_length=200)
    start_time = models.DateTimeField()
    end_time = models.DateTimeField()
    max_participants = models.IntegerField()
    cover_image = models.URLField()
    check_in_code = models.CharField(max_length=10)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES)

class ActivityRegistration(models.Model):
    activity = models.ForeignKey(Activity, on_delete=models.CASCADE)
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    reason = models.TextField()
    status = models.CharField(max_length=20, choices=STATUS_CHOICES)
    reviewer = models.ForeignKey(User, on_delete=models.SET_NULL)

class ActivityCheckIn(models.Model):
    registration = models.OneToOneField(ActivityRegistration, on_delete=models.CASCADE)
    checked_in_at = models.DateTimeField(auto_now_add=True)
```

#### ç­¾åˆ°æµç¨‹
1. æ´»åŠ¨ç®¡ç†å‘˜ç”Ÿæˆ6ä½æ•°å­—ç­¾åˆ°ç 
2. æ´»åŠ¨å¼€å§‹åï¼Œç”¨æˆ·è¾“å…¥ç­¾åˆ°ç 
3. ç³»ç»ŸéªŒè¯ç­¾åˆ°ç å¹¶è®°å½•ç­¾åˆ°æ—¶é—´
4. ç®¡ç†å‘˜å¯æŸ¥çœ‹ç­¾åˆ°ç»Ÿè®¡å’Œè¯¦æƒ…

---

### 4. èŠå¤©ç³»ç»Ÿæ¨¡å— (chat)

#### åŠŸèƒ½åˆ—è¡¨
- âœ… å®æ—¶ç¾¤èŠï¼ˆWebSocketï¼‰
- âœ… è‡ªåŠ¨åˆ›å»ºç¤¾å›¢ç¾¤ç»„
- âœ… è‡ªåŠ¨åˆ›å»ºæ´»åŠ¨ç¾¤ç»„
- âœ… æ¶ˆæ¯å‘é€/æ¥æ”¶
- âœ… æœªè¯»æ¶ˆæ¯æé†’
- âœ… èŠå¤©å®¤åˆ—è¡¨
- âœ… æ¶ˆæ¯å†å²è®°å½•

#### æ ¸å¿ƒæ¨¡å‹
```python
class ChatRoom(models.Model):
    name = models.CharField(max_length=200)
    room_type = models.CharField(max_length=20, choices=TYPE_CHOICES)
    club = models.ForeignKey(Club, on_delete=models.CASCADE)
    activity = models.ForeignKey(Activity, on_delete=models.CASCADE)
    avatar = models.ImageField(upload_to='chat/avatars/')

class ChatRoomMember(models.Model):
    room = models.ForeignKey(ChatRoom, on_delete=models.CASCADE)
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    last_read_at = models.DateTimeField()

class ChatMessage(models.Model):
    room = models.ForeignKey(ChatRoom, on_delete=models.CASCADE)
    sender = models.ForeignKey(User, on_delete=models.CASCADE)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
```

#### WebSocketé€šä¿¡
- **è¿æ¥URL**: `/ws/chat/<room_id>/`
- **æ¶ˆæ¯æ ¼å¼**:
```json
{
    "type": "chat_message",
    "message": {
        "id": 123,
        "sender": "username",
        "content": "æ¶ˆæ¯å†…å®¹",
        "timestamp": "2026-02-22 20:00:00"
    }
}
```

#### è‡ªåŠ¨ç¾¤ç»„åˆ›å»º
- **ç¤¾å›¢ç¾¤ç»„**: ç”¨æˆ·åŠ å…¥ç¤¾å›¢æ—¶è‡ªåŠ¨åŠ å…¥ç¤¾å›¢ç¾¤
- **æ´»åŠ¨ç¾¤ç»„**: ç”¨æˆ·æŠ¥åæ´»åŠ¨é€šè¿‡åè‡ªåŠ¨åŠ å…¥æ´»åŠ¨ç¾¤

---

### 5. é€šçŸ¥ç³»ç»Ÿæ¨¡å—

#### åŠŸèƒ½åˆ—è¡¨
- âœ… å®æ—¶é€šçŸ¥æ¨é€ï¼ˆWebSocketï¼‰
- âœ… é€šçŸ¥åˆ—è¡¨æŸ¥çœ‹
- âœ… æ ‡è®°å·²è¯»/æœªè¯»
- âœ… é€šçŸ¥åˆ†ç±»ï¼ˆç¤¾å›¢ç”³è¯·ã€æ´»åŠ¨æŠ¥åã€è¯„è®ºç­‰ï¼‰
- âœ… é€šçŸ¥è·³è½¬é“¾æ¥

#### æ ¸å¿ƒæ¨¡å‹
```python
class Notification(models.Model):
    recipient = models.ForeignKey(User, on_delete=models.CASCADE)
    sender = models.ForeignKey(User, on_delete=models.CASCADE)
    notification_type = models.CharField(max_length=30, choices=TYPE_CHOICES)
    title = models.CharField(max_length=200)
    content = models.TextField()
    link = models.CharField(max_length=500)
    is_read = models.BooleanField(default=False)
```

#### é€šçŸ¥ç±»å‹
- `club_application` - ç¤¾å›¢å…¥ä¼šç”³è¯·
- `club_creation` - åˆ›å»ºç¤¾å›¢ç”³è¯·
- `activity_registration` - æ´»åŠ¨æŠ¥åç”³è¯·
- `activity_comment` - æ´»åŠ¨è¯„è®º
- `system` - ç³»ç»Ÿé€šçŸ¥

#### é€šçŸ¥æ¨é€æµç¨‹
1. è§¦å‘äº‹ä»¶ï¼ˆå¦‚ç”³è¯·å®¡æ‰¹ï¼‰
2. åˆ›å»ºé€šçŸ¥è®°å½•
3. é€šè¿‡WebSocketæ¨é€ç»™ç”¨æˆ·
4. å‰ç«¯æ˜¾ç¤ºé€šçŸ¥å¼¹çª—å’Œçº¢ç‚¹æé†’

---

### 6. ç³»ç»Ÿç®¡ç†æ¨¡å— (system_admin)

#### åŠŸèƒ½åˆ—è¡¨
- âœ… ç³»ç»Ÿæ¦‚è§ˆï¼ˆç»Ÿè®¡æ•°æ®ï¼‰
- âœ… ç¤¾å›¢ç®¡ç†ï¼ˆå…¨éƒ¨ç¤¾å›¢çš„å¢åˆ æ”¹æŸ¥ï¼‰
- âœ… æ´»åŠ¨ç®¡ç†ï¼ˆå…¨éƒ¨æ´»åŠ¨çš„å¢åˆ æ”¹æŸ¥ï¼‰
- âœ… ç”³è¯·ç®¡ç†ï¼ˆå®¡æ‰¹åˆ›å»ºç¤¾å›¢ç”³è¯·ï¼‰
- âœ… ç”¨æˆ·ç®¡ç†ï¼ˆå…¨éƒ¨ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥ï¼‰

#### æƒé™æ§åˆ¶
- ä»…è¶…çº§ç®¡ç†å‘˜ï¼ˆ`is_superuser=True`ï¼‰å¯è®¿é—®
- ä½¿ç”¨ `@user_passes_test(is_superuser)` è£…é¥°å™¨

#### ä¸»è¦è§†å›¾
- `admin_home()` - ç³»ç»Ÿæ¦‚è§ˆ
- `club_management()` - ç¤¾å›¢ç®¡ç†
- `activity_management()` - æ´»åŠ¨ç®¡ç†
- `application_management()` - ç”³è¯·ç®¡ç†
- `user_management()` - ç”¨æˆ·ç®¡ç†

---

## æ•°æ®åº“è®¾è®¡

### ERå›¾æ¦‚è§ˆ
```
User â”€â”€â”¬â”€â”€â”€ Membership â”€â”€â”€ Club â”€â”€â”¬â”€â”€â”€ Activity
       â”‚                          â”‚
       â”œâ”€â”€â”€ ClubApplication        â”œâ”€â”€â”€ ActivityRegistration
       â”‚                          â”‚
       â”œâ”€â”€â”€ ClubCreationApplicationâ”œâ”€â”€â”€ ActivityCheckIn
       â”‚                          â”‚
       â”œâ”€â”€â”€ ChatMessage            â””â”€â”€â”€ ActivityComment
       â”‚
       â”œâ”€â”€â”€ ChatRoomMember â”€â”€â”€ ChatRoom
       â”‚
       â””â”€â”€â”€ Notification
```

### ä¸»è¦æ•°æ®è¡¨

#### ç”¨æˆ·ç›¸å…³
- `accounts_user` - ç”¨æˆ·è¡¨
- `accounts_notification` - é€šçŸ¥è¡¨

#### ç¤¾å›¢ç›¸å…³
- `clubs_club` - ç¤¾å›¢è¡¨
- `clubs_membership` - æˆå‘˜å…³ç³»è¡¨
- `clubs_clubapplication` - å…¥ä¼šç”³è¯·è¡¨
- `clubs_clubcreationapplication` - åˆ›å»ºç¤¾å›¢ç”³è¯·è¡¨

#### æ´»åŠ¨ç›¸å…³
- `activities_activity` - æ´»åŠ¨è¡¨
- `activities_activityregistration` - æŠ¥åè¡¨
- `activities_activitycheckin` - ç­¾åˆ°è¡¨
- `activities_activitycomment` - è¯„è®ºè¡¨

#### èŠå¤©ç›¸å…³
- `chat_chatroom` - èŠå¤©å®¤è¡¨
- `chat_chatroommember` - èŠå¤©å®¤æˆå‘˜è¡¨
- `chat_chatmessage` - æ¶ˆæ¯è¡¨

---

## å®‰è£…éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- Python 3.7.5+
- pip
- virtualenv

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd æ ¡å›­ç¤¾å›¢æ´»åŠ¨ç®¡ç†ç³»ç»Ÿ1
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
python -m venv venv
```

#### 3. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
```bash
# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

#### 4. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

#### 5. é…ç½®æ•°æ®åº“
```bash
python manage.py makemigrations
python manage.py migrate
```

#### 6. åˆ›å»ºè¶…çº§ç®¡ç†å‘˜
```bash
python manage.py createsuperuser
```

#### 7. æ”¶é›†é™æ€æ–‡ä»¶ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```bash
python manage.py collectstatic
```

#### 8. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
# ä½¿ç”¨Daphneï¼ˆæ”¯æŒWebSocketï¼‰
daphne -b 127.0.0.1 -p 8000 club_management.asgi:application

# æˆ–ä½¿ç”¨Djangoå¼€å‘æœåŠ¡å™¨ï¼ˆä¸æ”¯æŒWebSocketï¼‰
python manage.py runserver
```

#### 9. è®¿é—®ç³»ç»Ÿ
- å‰å°: http://127.0.0.1:8000/
- ç®¡ç†åå°: http://127.0.0.1:8000/admin/

---

## APIæ¥å£

### ç”¨æˆ·ç›¸å…³
| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/accounts/register/` | POST | ç”¨æˆ·æ³¨å†Œ |
| `/accounts/login/` | POST | ç”¨æˆ·ç™»å½• |
| `/accounts/logout/` | POST | ç”¨æˆ·ç™»å‡º |
| `/accounts/profile/update/` | POST | æ›´æ–°èµ„æ–™ |
| `/accounts/profile/change-password/` | POST | ä¿®æ”¹å¯†ç  |
| `/accounts/profile/upload-avatar/` | POST | ä¸Šä¼ å¤´åƒ |
| `/accounts/notifications/` | GET | é€šçŸ¥åˆ—è¡¨ |
| `/accounts/api/notifications/unread-count/` | GET | æœªè¯»é€šçŸ¥æ•° |

### ç¤¾å›¢ç›¸å…³
| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/clubs/` | GET | ç¤¾å›¢åˆ—è¡¨ |
| `/clubs/<id>/` | GET | ç¤¾å›¢è¯¦æƒ… |
| `/clubs/<id>/apply/` | POST | ç”³è¯·åŠ å…¥ç¤¾å›¢ |
| `/dashboard/<id>/edit/` | POST | ç¼–è¾‘ç¤¾å›¢ä¿¡æ¯ |
| `/dashboard/<id>/upload-logo/` | POST | ä¸Šä¼ Logo |
| `/dashboard/<id>/upload-cover/` | POST | ä¸Šä¼ å°é¢ |
| `/dashboard/<id>/members/add/` | POST | æ·»åŠ æˆå‘˜ |
| `/dashboard/<id>/members/<mid>/update-role/` | POST | æ›´æ–°æˆå‘˜è§’è‰² |
| `/dashboard/<id>/members/<mid>/remove/` | POST | ç§»é™¤æˆå‘˜ |

### æ´»åŠ¨ç›¸å…³
| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/activities/` | GET | æ´»åŠ¨åˆ—è¡¨ |
| `/activities/<id>/` | GET | æ´»åŠ¨è¯¦æƒ… |
| `/activities/<id>/register/` | POST | æŠ¥åæ´»åŠ¨ |
| `/activities/<id>/check-in/` | POST | æ´»åŠ¨ç­¾åˆ° |
| `/activities/<id>/comment/` | POST | å‘è¡¨è¯„è®º |
| `/dashboard/<cid>/activities/<aid>/registrations/<rid>/approve/` | POST | é€šè¿‡æŠ¥å |
| `/dashboard/<cid>/activities/<aid>/registrations/<rid>/reject/` | POST | æ‹’ç»æŠ¥å |
| `/dashboard/<cid>/activities/<aid>/generate-check-in-code/` | POST | ç”Ÿæˆç­¾åˆ°ç  |

### èŠå¤©ç›¸å…³
| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/chat/` | GET | èŠå¤©å®¤åˆ—è¡¨ |
| `/chat/<room_id>/` | GET | èŠå¤©å®¤è¯¦æƒ… |
| `/chat/api/unread-count/` | GET | æœªè¯»æ¶ˆæ¯æ•° |
| `/ws/chat/<room_id>/` | WebSocket | èŠå¤©WebSocket |

---

## WebSocketé€šä¿¡

### é€šçŸ¥WebSocket

#### è¿æ¥
```javascript
const wsUrl = 'ws://127.0.0.1:8000/ws/notifications/';
const socket = new WebSocket(wsUrl);
```

#### æ¥æ”¶æ¶ˆæ¯
```javascript
socket.onmessage = function(e) {
    const data = JSON.parse(e.data);
    
    if (data.type === 'notification') {
        // æ–°é€šçŸ¥
        console.log(data.notification);
    } else if (data.type === 'unread_count') {
        // æœªè¯»æ•°é‡
        console.log(data.count);
    }
};
```

#### æ ‡è®°å·²è¯»
```javascript
socket.send(JSON.stringify({
    type: 'mark_read',
    notification_id: 123
}));
```

### èŠå¤©WebSocket

#### è¿æ¥
```javascript
const roomId = 1;
const wsUrl = `ws://127.0.0.1:8000/ws/chat/${roomId}/`;
const socket = new WebSocket(wsUrl);
```

#### å‘é€æ¶ˆæ¯
```javascript
socket.send(JSON.stringify({
    message: 'ä½ å¥½ï¼Œä¸–ç•Œï¼'
}));
```

#### æ¥æ”¶æ¶ˆæ¯
```javascript
socket.onmessage = function(e) {
    const data = JSON.parse(e.data);
    console.log(data.message);
};
```

---


### æ•°æ®åº“è¿ç§»
```bash
# åˆ›å»ºè¿ç§»æ–‡ä»¶
python manage.py makemigrations

# åº”ç”¨è¿ç§»
python manage.py migrate

# æŸ¥çœ‹è¿ç§»çŠ¶æ€
python manage.py showmigrations
```

### é™æ€æ–‡ä»¶ç®¡ç†
- å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨ `STATICFILES_DIRS`
- ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ `collectstatic` æ”¶é›†åˆ° `STATIC_ROOT`

---

#




